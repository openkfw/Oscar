# Initial data load service

## Environment Variables

| Env Variable                       | Required | Default Value                                                      | Description                                                                                                                                                                                                                                                                                                      |
| ---------------------------------- | -------- | ------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| NODE_ENV                           | no       | development                                                        | This environment variable is used to state in our case whether a particular environment is development, production, test or provision environment. Express uses it to alter its own default behavior. Fo example a common use-case is running additional debugging or logging code in a development environment. |
| PORT                               | no       | 8080                                                               | The port on which the service is running.                                                                                                                                                                                                                                                                        |
| LOG_LABEL                          | no       | oscar-initial-data-upload                                          | Title of the logs that you can see in the terminal when you run the service.                                                                                                                                                                                                                                     |
| AZURE_STORAGE_CONNECTION_STRING    | yes      | -                                                                  | Connection string for Azure Storage (in cloud or Azurite locally).                                                                                                                                                                                                                               |
| AZURE_STORAGE_LAYER_CONTAINER_NAME | yes      | layer-geo-data                                                     | Name of the Blob Container to which geojsons are saved in the Azurite.                                             |
| MONGO_URI                          | yes      | mongodb://localhost:27917/oscar or mongodb://localhost:27017/oscar | URI with port on which the MongoDB is running. In the development environment it runs on port 27917 and in the testing environment on port 27017.                                                                                                                                                                |
| UPLOAD_DATA_TYPES                  | no       | -                                                                  | List of datasets, to be uploaded into the database, separated by comma. There are two options: 'mapLayers' for the map view configuration and 'attributes' for application data.                                                                                                                                                        |
| COUNTRY                            | yes      | ''                                                                 | Name of the folder from which you get the data for the specific country.                                                                                                                                                                                                                                         |
| NEW_STORAGE_CONTAINERS             | no       | ''                                                                 | Names of the Blob Containers to be created in Azure Storage..                                                                                                                                                                                                                                                                     |
| NEW_STORAGE_QUEUES                 | no       | ''                                                                 | Names of the Storage Queues to be created in Azure Storage..                                                                                                                                                                                                                                                                   |

## Overview

Initial data load service sets up database structure, indexes and storage structure necessary for data storing. Then it fills database and storage with data. You need to set some environment variables settings and configuration files and put data, that you want to upload, in `/initial-data-load/data/{COUNTRY}` folder first. These are:

- Geographical location data for map layer, that are stored in geojson format.
- Data related to the point or area for map layer, that are stored in geojson or csv format.

Once everything is set you can start the application with `start.sh` script, run this service (even more than once) with `runinitialload.sh` script and refresh web page in browser. You can see map layers in map view and graphs filled with data on the dashboard.

For a detailed description how to achieve this check [Run application with own data](../tutorials/run-application-with-own-data.md).
