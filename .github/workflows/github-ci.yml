name: Oscar's Github CI

on: [push]

jobs:
  # Security jobs
  security-frontend:
    name: Check code security of frontend
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout this Github repository
        uses: actions/checkout@v2
      - name: Set up and use Node 14
        uses: actions/setup-node@v2
        with:
          node-version: '14'
      - run: |
          cd frontend 
          yarn --frozen-lockfile
          yarn audit
          yarn lint:ci
  security-api:
    name: Check code security of api 
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout this Github repository 
        uses: actions/checkout@v2 
      - name: Set up and use Node 14 
        uses: actions/setup-node@v2
        with:
          node-version: '14'
      - run: |
          cd api
          yarn --frozen-lockfile
          yarn audit
          yarn lint:ci 
  security-initial-data-load:
    name: Check code security of initial-data-load
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout this Github repository 
        uses: actions/checkout@v2 
      - name: Set up and use Node 14 
        uses: actions/setup-node@v2
        with:
          node-version: '14'
      - run: |
          cd initial-data-load
          yarn --frozen-lockfile
          yarn audit
          yarn lint:ci 
  # Test jobs
  test-entire-app:
    name: Test the code of the entire app
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout this Github repository 
        uses: actions/checkout@v2
      - name: Set up and use Node 14
        uses: actions/setup-node@v2
        with: 
          node-version: '14'
      - run: |
          echo $NPM_REGISTRY 
          echo $NPM_RC 
          pwd 
          yarn --frozen-lockfile
          yarn test:coverage 